<div class="container">
	<div class="jumbotron text-center" ng-controller="NavController" ng-show="isLoggedIn()">
	    <h1>Welcome To Flavors</h1>
	    <ul class="list-unstyled">
	    	<h2></h2>
			<li ng-hide="isLoggedIn()"><a href="/#/login">Log In</a></li>
	    	<li ng-hide="isLoggedIn()"><a href="/#/register">Register</a></li>
		</ul>
	</div>
</div>
<div class='flavors'>
	<div ng-show="isLoggedIn()">

		<div ng-show="error" class="alert alert-danger">
			<span>{{ error }}</span>
		</div>

		<form ng-submit='addFlavor()'>
			<textarea id="flavorBox" ng-model="title" placeholder='Post new Flavor'></textarea>
			<br>
			<a href="#" onclick="document.getElementById('file_input').click(); return false;" />
				<div>Upload Flavor Picture</div>
			</a>
			<div class="btn btn-default" ng-click="removePhoto()" ng-hide='!temporaryPicture'>X</div>
			<img class='preview' ng-src="{{temporaryPicture}}" ng-hide='!temporaryPicture'/>
			<input type="file" id="file_input" style="visibility: hidden;" onchange="angular.element(this).scope().readURL()"/>
			<button class="btn btn-primary"type="submit">Post Flavor</button>
		</form>
		<br>

		<div ng-repeat="flavor in flavors| orderBy:'date': true">
			<div class="flavor">
				<div class='flavorAuthor'>
					<img class="profilePic" ng-src="{{flavor.user.profilepicture}}" ng-hide='!flavor.user.profilepicture' alt='{{flavor.user.profilepicture}}'/>
					<span ng-show="flavor.user.username">
						<a>{{flavor.user.username}}</a>
					</span>
					<span>
						{{flavor.date| date: 'MMM dd, yyyy HH:mm'}}
					</span>
				</div>

				{{flavor.title}}
				<br>
				<a href="#/flavors/{{flavor._id}}">
					<img class="flavorPicture" ng-src="{{flavor.picture}}" ng-hide='!flavor.picture' alt='{{flavor.picture}}'/>
				</a>
				<div class='upvote'>
					<span class="glyphicon glyphicon-thumbs-up" ng-click="incrementUpvotes(flavor)"></span> {{flavor.upvotes}} likes
					<a ng-click="showComments(flavor._id)"><span>{{flavor.comments.length}} comments</span><a>
<!-- 					<span ng-repeat='upvotedBy in flavor.upvotesBy'>
						{{upvotedBy}}
					</span> -->
				</div>
			</div>
			<div class="commentsDiv" ng-hide='!flavorShowComments || flavorShowComments !== flavor._id'>
				<div ng-repeat="comment in flavor.comments | orderBy:'date': true">
					<br>
					<img class="profilePic" ng-src="{{comment.user.profilepicture}}" ng-hide='!comment.user.profilepicture' alt='{{comment.user.profilepicture}}'/>
					<span><a>{{comment.user.username}}</a> </span>
					<span>
						{{comment.date| date: 'MMM dd, yyyy HH:mm'}}
					</span>
					<br>
					<div class="commentBody">
						<span>{{comment.body}}</span>
						<br>
						<span class="glyphicon glyphicon-thumbs-up" ng-click="incrementCommentUpvotes(flavor, comment)"></span>
						{{comment.upvotes}} likes
					</div>
				</div>
				<form  ng-submit="addComment(flavor)">
					<textarea id="commentBox" placeholder="Add new comment" ng-model="body"></textarea>
					<br>
					<button type="submit" class="btn btn-primary">Post Comment</button>
				</form>
			</div>
			<br>
		</div>

	</div>
</div>